# 実装計画

- [x] 1. プロジェクト構造とコアインターフェースの設定

  - Chrome 拡張機能のディレクトリ構造を作成（popup、background、content、services、types）
  - TypeScript の設定とビルド環境を構築
  - Manifest V3 の基本設定ファイルを作成
  - _要件: 5.1, 5.2_

- [x] 2. データモデルとバリデーションの実装
- [x] 2.1 コアデータモデルインターフェースと型の作成

  - XProfile、NameTagTemplate、AppSettings の TypeScript インターフェースを定義
  - データバリデーション関数を実装
  - _要件: 1.1, 2.1_

- [x] 2.2 エラーハンドリング型とユーティリティの実装

  - APIError、ErrorCodes の型定義を作成
  - エラー表示とハンドリングのユーティリティ関数を実装
  - _要件: 3.3_

- [x] 3. プロフィール取得サービスの実装
- [x] 3.1 ProfileService の基本実装

  - 単一プロフィール取得機能を実装
  - X プロフィール URL の解析とバリデーション機能を作成
  - プロフィール情報抽出の DOM 解析ロジックを実装
  - _要件: 1.1_

- [x] 3.2 複数プロフィール取得機能の実装

  - 一括プロフィール取得機能を実装
  - エラー処理と部分的成功のハンドリングを追加
  - レート制限とタイムアウト処理を実装
  - _要件: 3.1, 3.3_

- [x] 3.3 プロフィール取得のテスト作成

  - ProfileService の単体テストを作成
  - モックデータを使用したテストケースを実装
  - エラーケースのテストを追加
  - _要件: 1.1, 3.1_

- [x] 4. 名札生成サービスの実装（TDD 方式）
- [x] 4.1 名札生成サービスのテスト作成（Red）

  - NameTagService の単体テストを作成（失敗するテストから開始）
  - 基本テンプレート生成のテストケースを実装
  - カスタマイズ機能のテストケースを追加
  - _要件: 2.1, 2.2_

- [x] 4.2 基本テンプレートシステムの実装（Green）

  - テストを通すための最小限の NameTagService 実装
  - デフォルト名札テンプレートを作成
  - Canvas API を使用した基本描画機能を実装
  - _要件: 2.1_

- [x] 4.3 カスタマイズ機能の実装とリファクタリング（Refactor）

  - フォントサイズ変更機能を実装
  - 色設定変更機能を実装
  - テンプレート選択機能を実装
  - コードの整理とリファクタリング
  - _要件: 2.2, 2.3_

- [x] 5. PDF 生成サービスの実装
- [x] 5.1 基本 PDF 生成機能の実装

  - jsPDF を使用した PDF 生成機能を実装
  - 単一名札の PDF 出力機能を作成
  - PDF 品質とサイズの最適化を実装
  - _要件: 1.3_

- [x] 5.2 複数名札 PDF 生成機能の実装

  - 複数名札を含む単一 PDF の生成機能を実装
  - ページレイアウトと配置の最適化を実装
  - メモリ使用量の監視と制限を追加
  - _要件: 3.2_

- [x] 5.3 PDF 生成サービスのテスト作成

  - PDFService の単体テストを作成
  - 生成された PDF の検証テストを実装
  - エラーケースとメモリ制限のテストを追加
  - _要件: 1.3, 3.2_

- [x] 6. 設定管理サービスの実装
- [x] 6.1 設定保存・読み込み機能の実装

  - Chrome Storage API を使用した設定管理を実装
  - デフォルト設定の初期化機能を作成
  - 設定のバリデーションとマイグレーション機能を実装
  - _要件: 2.2, 2.3_

- [x] 6.2 設定管理のテスト作成

  - SettingsService の単体テストを作成
  - 設定の保存・読み込みテストを実装
  - バリデーションエラーのテストを追加
  - _要件: 2.2_

- [ ] 7. Chrome 拡張機能 UI の実装
- [ ] 7.1 ポップアップ UI の基本実装

  - popup.html の基本レイアウトを作成
  - プロフィール URL 入力フィールドを実装
  - 生成ボタンとプログレス表示を追加
  - _要件: 5.1_

- [ ] 7.2 設定パネル UI の実装

  - 名札設定パネルの UI を作成
  - テンプレート選択、フォント、色設定のコントロールを実装
  - リアルタイムプレビュー機能を追加
  - _要件: 2.1, 2.2, 2.3_

- [ ] 7.3 エラー表示とユーザーフィードバックの実装

  - エラーメッセージ表示機能を実装
  - 成功・警告通知の表示機能を追加
  - 再試行オプションの UI を実装
  - _要件: 3.3, 4.3_

- [ ] 8. バックグラウンドスクリプトの実装
- [ ] 8.1 拡張機能の初期化とライフサイクル管理

  - background.ts の基本実装を作成
  - 拡張機能のインストール・更新処理を実装
  - アイコンとコンテキストメニューの管理を追加
  - _要件: 5.2_

- [ ] 8.2 タブ管理とコンテンツスクリプト連携

  - アクティブタブの情報取得機能を実装
  - コンテンツスクリプトとの通信機能を追加
  - 権限管理とセキュリティ制御を実装
  - _要件: 5.3_

- [ ] 9. コンテンツスクリプトの実装
- [ ] 9.1 X プロフィールページ検出機能

  - 現在のページが X プロフィールページかを判定する機能を実装
  - プロフィール URL の自動抽出機能を作成
  - ページ情報の取得とポップアップへの送信機能を実装
  - _要件: 5.3_

- [ ] 9.2 コンテンツスクリプトのテスト作成

  - コンテンツスクリプトの単体テストを作成
  - ページ検出機能のテストを実装
  - 通信機能のテストを追加
  - _要件: 5.3_

- [ ] 10. ファイルダウンロード機能の実装
- [ ] 10.1 PDF 自動ダウンロード機能

  - PDF 生成完了時の自動ダウンロード機能を実装
  - ファイル名の自動生成機能を追加
  - ダウンロード設定の管理機能を実装
  - _要件: 4.1_

- [ ] 10.2 手動ダウンロードとエラーハンドリング

  - ダウンロードボタンの実装
  - ダウンロード失敗時のエラーハンドリングを追加
  - 再試行機能とエラー表示を実装
  - _要件: 4.2, 4.3_

- [ ] 11. 統合テストと E2E テストの実装
- [ ] 11.1 Chrome 拡張機能の統合テスト

  - ポップアップとバックグラウンドスクリプトの連携テストを作成
  - コンテンツスクリプトとの通信テストを実装
  - 設定の永続化テストを追加
  - _要件: 5.1, 5.2, 5.3_

- [ ] 11.2 エンドツーエンドテストの実装

  - 実際のプロフィール URL を使用した名札生成テストを作成
  - 複数プロフィールの一括処理テストを実装
  - 異なるテンプレートでの生成テストを追加
  - _要件: 1.1, 1.2, 1.3, 3.1, 3.2_

- [ ] 12. ビルドとパッケージングの設定
- [ ] 12.1 本番ビルド設定の実装

  - Webpack または Vite を使用したビルド設定を作成
  - TypeScript コンパイルとバンドル設定を実装
  - Chrome 拡張機能パッケージング設定を追加
  - _要件: 5.1, 5.2_

- [ ] 12.2 開発環境とデバッグ設定
  - 開発用のホットリロード設定を実装
  - デバッグ用のソースマップ設定を追加
  - テスト実行環境の設定を完成
  - _要件: 全体的な開発効率_
